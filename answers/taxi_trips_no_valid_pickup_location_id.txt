-- Q2 taxi_trips_no_valid_pickup_location_id.sql
.read ../nyc_transit/target/compiled/nyc_transit/analyses/taxi_trips_no_valid_pickup_location_id.sql
SELECT
    type,
    pickup_datetime,
    dropoff_datetime,
    duration_min,
    duration_sec,
    pulocationid,
    dolocationid,
    dim_loc.locationid, -- make sure it is null, i.e. no valid record in dim_location table
    dim_loc.borough -- make sure it is null, i.e. no valid record in dim_location table
FROM 
    "main"."mart"."mart__fact_all_taxi_trips" taxi_trip
LEFT JOIN "main"."mart"."mart__dim_locations" dim_loc ON taxi_trip.pulocationid = dim_loc.locationid
WHERE dim_loc.locationid is NULL -- keeping those trips without valid pickup location in dim_location table
┌─────────┬─────────────────────┬─────────────────────┬───┬──────────────┬──────────────┬────────────┬─────────┐
│  type   │   pickup_datetime   │  dropOff_datetime   │ … │ PUlocationID │ DOlocationID │ LocationID │ Borough │
│ varchar │      timestamp      │      timestamp      │   │    double    │    double    │   int32    │ varchar │
├─────────┼─────────────────────┼─────────────────────┼───┼──────────────┼──────────────┼────────────┼─────────┤
│ fhv     │ 2020-03-02 22:32:58 │ 2020-03-02 22:37:29 │ … │              │         66.0 │            │         │
│ fhv     │ 2020-03-02 22:46:42 │ 2020-03-02 23:02:45 │ … │              │        225.0 │            │         │
│ fhv     │ 2020-03-02 22:42:15 │ 2020-03-02 22:53:36 │ … │              │         61.0 │            │         │
│ fhv     │ 2020-03-02 22:20:10 │ 2020-03-02 22:38:42 │ … │              │        254.0 │            │         │
│ fhv     │ 2020-03-02 22:53:47 │ 2020-03-02 23:07:05 │ … │              │        265.0 │            │         │
│ fhv     │ 2020-03-02 22:28:20 │ 2020-03-02 22:34:31 │ … │              │          3.0 │            │         │
│ fhv     │ 2020-03-02 22:41:47 │ 2020-03-02 22:49:01 │ … │              │        254.0 │            │         │
│ fhv     │ 2020-03-02 22:38:20 │ 2020-03-03 01:06:41 │ … │              │        209.0 │            │         │
│ fhv     │ 2020-03-02 22:46:02 │ 2020-03-02 22:53:50 │ … │              │        265.0 │            │         │
│ fhv     │ 2020-03-02 22:32:51 │ 2020-03-02 22:50:55 │ … │              │        159.0 │            │         │
│ fhv     │ 2020-03-02 22:38:07 │ 2020-03-02 22:49:28 │ … │              │        212.0 │            │         │
│ fhv     │ 2020-03-02 22:03:25 │ 2020-03-02 22:12:39 │ … │              │        213.0 │            │         │
│ fhv     │ 2020-03-02 22:22:27 │ 2020-03-02 22:34:04 │ … │              │         47.0 │            │         │
│ fhv     │ 2020-03-02 22:06:34 │ 2020-03-02 22:33:55 │ … │              │        136.0 │            │         │
│ fhv     │ 2020-03-02 22:08:47 │ 2020-03-02 22:16:58 │ … │              │         81.0 │            │         │
│ fhv     │ 2020-03-02 22:29:18 │ 2020-03-02 22:37:55 │ … │              │          3.0 │            │         │
│ fhv     │ 2020-03-02 22:42:15 │ 2020-03-02 23:24:55 │ … │              │        174.0 │            │         │
│ fhv     │ 2020-03-02 22:34:28 │ 2020-03-02 22:46:14 │ … │              │          3.0 │            │         │
│ fhv     │ 2020-03-02 22:04:59 │ 2020-03-02 22:08:38 │ … │              │        254.0 │            │         │
│ fhv     │ 2020-03-02 22:16:14 │ 2020-03-02 22:29:53 │ … │              │         78.0 │            │         │
│ fhv     │ 2020-03-02 22:55:09 │ 2020-03-02 23:04:39 │ … │              │        265.0 │            │         │
│ fhv     │ 2020-03-02 22:41:55 │ 2020-03-02 22:50:41 │ … │              │        254.0 │            │         │
│ fhv     │ 2020-03-02 22:01:50 │ 2020-03-02 22:24:23 │ … │              │        265.0 │            │         │
│ fhv     │ 2020-03-02 22:31:17 │ 2020-03-02 22:41:30 │ … │              │         51.0 │            │         │
│ fhv     │ 2020-03-02 22:17:12 │ 2020-03-02 22:35:07 │ … │              │         81.0 │            │         │
│ fhv     │ 2020-03-02 22:40:17 │ 2020-03-02 22:48:57 │ … │              │          3.0 │            │         │
│ fhv     │ 2020-03-02 22:53:51 │ 2020-03-02 23:00:45 │ … │              │         81.0 │            │         │
│ fhv     │ 2020-03-02 22:40:18 │ 2020-03-02 22:47:02 │ … │              │         81.0 │            │         │
│ fhv     │ 2020-03-02 22:49:48 │ 2020-03-02 22:55:43 │ … │              │        259.0 │            │         │
│ fhv     │ 2020-03-02 22:21:40 │ 2020-03-02 22:43:10 │ … │              │        200.0 │            │         │
│ fhv     │ 2020-03-02 22:37:30 │ 2020-03-02 22:40:46 │ … │              │        265.0 │            │         │
│ fhv     │ 2020-03-02 22:46:47 │ 2020-03-02 22:57:09 │ … │              │         81.0 │            │         │
│ fhv     │ 2020-03-02 22:28:18 │ 2020-03-02 22:31:34 │ … │              │         36.0 │            │         │
│ fhv     │ 2020-03-02 22:04:26 │ 2020-03-02 22:08:50 │ … │              │        225.0 │            │         │
│ fhv     │ 2020-03-02 22:56:51 │ 2020-03-02 22:59:55 │ … │              │         80.0 │            │         │
│ fhv     │ 2020-03-02 22:45:36 │ 2020-03-02 22:54:01 │ … │              │         35.0 │            │         │
│ fhv     │ 2020-03-02 22:54:14 │ 2020-03-02 23:01:49 │ … │              │         77.0 │            │         │
│ fhv     │ 2020-03-02 22:25:35 │ 2020-03-02 22:30:48 │ … │              │         76.0 │            │         │
│ fhv     │ 2020-03-02 22:46:41 │ 2020-03-02 22:52:34 │ … │              │         76.0 │            │         │
│ fhv     │ 2020-03-02 22:05:36 │ 2020-03-02 22:08:37 │ … │              │        119.0 │            │         │
│ fhv     │ 2020-03-02 22:39:07 │ 2020-03-02 22:46:02 │ … │              │        116.0 │            │         │
│ fhv     │ 2020-03-02 22:01:31 │ 2020-03-02 22:07:42 │ … │              │        119.0 │            │         │
│ fhv     │ 2020-03-02 22:04:53 │ 2020-03-02 22:15:32 │ … │              │        168.0 │            │         │
│ fhv     │ 2020-03-02 22:26:06 │ 2020-03-02 22:35:47 │ … │              │         42.0 │            │         │
│ fhv     │ 2020-03-02 22:54:36 │ 2020-03-02 23:13:27 │ … │              │         18.0 │            │         │
│ fhv     │ 2020-03-02 22:22:28 │ 2020-03-02 22:30:48 │ … │              │        244.0 │            │         │
│ fhv     │ 2020-03-02 22:43:05 │ 2020-03-02 22:51:42 │ … │              │         42.0 │            │         │
│ fhv     │ 2020-03-02 22:41:23 │ 2020-03-02 22:59:11 │ … │              │        244.0 │            │         │
│ fhv     │ 2020-03-02 22:15:52 │ 2020-03-02 22:29:51 │ … │              │        235.0 │            │         │
│ fhv     │ 2020-03-02 22:12:00 │ 2020-03-02 22:32:47 │ … │              │        241.0 │            │         │
│  ·      │          ·          │          ·          │ · │      ·       │          ·   │     ·      │    ·    │
│  ·      │          ·          │          ·          │ · │      ·       │          ·   │     ·      │    ·    │
│  ·      │          ·          │          ·          │ · │      ·       │          ·   │     ·      │    ·    │
│ fhv     │ 2020-12-27 03:22:49 │ 2020-12-27 03:28:32 │ … │              │        235.0 │            │         │
│ fhv     │ 2020-12-27 03:35:27 │ 2020-12-27 03:42:56 │ … │              │        241.0 │            │         │
│ fhv     │ 2020-12-27 03:51:15 │ 2020-12-27 04:01:59 │ … │              │        116.0 │            │         │
│ fhv     │ 2020-12-27 03:02:48 │ 2020-12-27 03:27:57 │ … │              │         71.0 │            │         │
│ fhv     │ 2020-12-27 03:28:43 │ 2020-12-27 03:33:00 │ … │              │        215.0 │            │         │
│ fhv     │ 2020-12-27 03:41:49 │ 2020-12-27 03:47:35 │ … │              │        130.0 │            │         │
│ fhv     │ 2020-12-27 03:28:38 │ 2020-12-27 03:35:31 │ … │              │        215.0 │            │         │
│ fhv     │ 2020-12-27 03:52:43 │ 2020-12-27 04:04:40 │ … │              │         82.0 │            │         │
│ fhv     │ 2020-12-27 03:04:26 │ 2020-12-27 03:10:38 │ … │              │        121.0 │            │         │
│ fhv     │ 2020-12-27 03:39:28 │ 2020-12-27 03:45:50 │ … │              │        216.0 │            │         │
│ fhv     │ 2020-12-27 03:10:04 │ 2020-12-27 03:14:34 │ … │              │        122.0 │            │         │
│ fhv     │ 2020-12-27 03:03:03 │ 2020-12-27 03:20:02 │ … │              │        130.0 │            │         │
│ fhv     │ 2020-12-27 03:34:29 │ 2020-12-27 03:56:00 │ … │              │        247.0 │            │         │
│ fhv     │ 2020-12-27 03:46:41 │ 2020-12-27 03:52:28 │ … │              │        244.0 │            │         │
│ fhv     │ 2020-12-27 03:49:04 │ 2020-12-27 04:02:29 │ … │              │        147.0 │            │         │
│ fhv     │ 2020-12-27 03:19:27 │ 2020-12-27 03:28:59 │ … │              │         74.0 │            │         │
│ fhv     │ 2020-12-27 03:03:20 │ 2020-12-27 03:47:39 │ … │              │          1.0 │            │         │
│ fhv     │ 2020-12-27 03:30:33 │ 2020-12-27 03:45:14 │ … │              │          9.0 │            │         │
│ fhv     │ 2020-12-27 03:57:43 │ 2020-12-27 04:05:29 │ … │              │         56.0 │            │         │
│ fhv     │ 2020-07-26 10:16:36 │ 2020-07-26 10:21:40 │ … │              │        171.0 │            │         │
│ fhv     │ 2020-07-26 13:04:24 │ 2020-07-26 13:16:56 │ … │              │        232.0 │            │         │
│ fhv     │ 2020-07-27 07:54:06 │ 2020-07-27 08:20:53 │ … │              │         93.0 │            │         │
│ fhv     │ 2020-07-27 08:46:08 │ 2020-07-27 09:04:56 │ … │              │         28.0 │            │         │
│ fhv     │ 2020-07-27 10:51:16 │ 2020-07-27 11:03:02 │ … │              │         73.0 │            │         │
│ fhv     │ 2020-07-27 11:06:51 │ 2020-07-27 11:08:37 │ … │              │         73.0 │            │         │
│ fhv     │ 2020-07-27 11:29:16 │ 2020-07-27 11:59:09 │ … │              │         93.0 │            │         │
│ fhv     │ 2020-07-27 12:15:59 │ 2020-07-27 12:16:06 │ … │              │         93.0 │            │         │
│ fhv     │ 2020-07-28 08:35:26 │ 2020-07-28 09:11:25 │ … │              │        192.0 │            │         │
│ fhv     │ 2020-07-28 10:35:40 │ 2020-07-28 10:43:15 │ … │              │        223.0 │            │         │
│ fhv     │ 2020-07-28 11:27:04 │ 2020-07-28 11:37:52 │ … │              │        253.0 │            │         │
│ fhv     │ 2020-01-07 11:12:03 │ 2020-01-07 11:29:33 │ … │              │         21.0 │            │         │
│ fhv     │ 2020-01-07 11:08:42 │ 2020-01-07 11:20:43 │ … │              │        228.0 │            │         │
│ fhv     │ 2020-01-07 11:48:49 │ 2020-01-07 11:55:49 │ … │              │         26.0 │            │         │
│ fhv     │ 2020-01-07 11:09:42 │ 2020-01-07 11:20:28 │ … │              │        228.0 │            │         │
│ fhv     │ 2020-01-07 11:49:01 │ 2020-01-07 11:54:07 │ … │              │        227.0 │            │         │
│ fhv     │ 2020-01-07 11:14:36 │ 2020-01-07 11:19:41 │ … │              │         26.0 │            │         │
│ fhv     │ 2020-01-07 11:00:00 │ 2020-01-07 11:17:33 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 11:30:00 │ 2020-01-07 11:50:00 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 11:00:00 │ 2020-01-07 11:30:00 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 11:03:07 │ 2020-01-07 11:28:34 │ … │              │        106.0 │            │         │
│ fhv     │ 2020-01-07 11:59:18 │ 2020-01-07 12:03:00 │ … │              │         89.0 │            │         │
│ fhv     │ 2020-01-07 11:57:53 │ 2020-01-07 12:03:57 │ … │              │         89.0 │            │         │
│ fhv     │ 2020-01-07 12:45:00 │ 2020-01-07 12:51:00 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 12:26:00 │ 2020-01-07 13:00:00 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 12:40:00 │ 2020-01-07 14:17:00 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 12:25:00 │ 2020-01-07 12:40:00 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 12:25:00 │ 2020-01-07 12:35:00 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 12:26:00 │ 2020-01-07 12:35:00 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 12:39:00 │ 2020-01-07 12:44:00 │ … │              │              │            │         │
│ fhv     │ 2020-01-07 12:35:09 │ 2020-01-07 12:58:16 │ … │              │         33.0 │            │         │
├─────────┴─────────────────────┴─────────────────────┴───┴──────────────┴──────────────┴────────────┴─────────┤
│ 15679790 rows (100 shown)                                                                9 columns (7 shown) │
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
